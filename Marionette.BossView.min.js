/*
* https://github.com/justspamjustin/BossView
* BossView v 0.1.3
*/
Backbone.Marionette.BossView=Backbone.Marionette.ItemView.extend({template:function(){return""},constructor:function(){Backbone.Marionette.ItemView.prototype.constructor.apply(this,arguments);this._initializeSubViews();this._initializeChildViewEvents();this._initializeSubViewEventBubbling();this.listenTo(this,"render",this._onParentRendered)},getParentEl:function(){return this.$el},_initializeSubViews:function(){this._eachSubView(_.bind(function(e,t){var n=this._getInitializedSubView(t);this._checkSubViewForRender(n,e);this[e]=n},this))},_getInitializedSubView:function(e){var t;var n=_.isFunction(e.prototype.render);if(n){t=this._initializeRenderableSubView(e)}else{t=e.call(this)}return t},_initializeRenderableSubView:function(e){return new e({model:this.model,collection:this.collection})},_checkSubViewForRender:function(e,t){if(_.isUndefined(e)||!_.isFunction(e.render)){throw new Error("The subview named "+t+" does not have a render function.")}},_initializeChildViewEvents:function(){this._eachSubViewEvent(_.bind(function(e,t,n){n=this._getSubViewEventCallbackFunction(n,t);if(e==="*"){this._listenToEventOnAllSubViews(n,t)}else{this.listenTo(e,t,n)}},this))},_getSubViewEventCallbackFunction:function(e,t){if(_.isString(e)){this._checkForSubViewEventCallback(e,t);e=this[e]}return e},_listenToEventOnAllSubViews:function(e,t){this._eachSubView(_.bind(function(n){var r=this[n];this.listenTo(r,t,e)},this))},_checkForSubViewEventCallback:function(e,t){if(_.isUndefined(this[e])){throw new Error("This view has no function named "+e+" to use as a callback for the event "+t)}},_initializeSubViewEventBubbling:function(){this._eachSubView(_.bind(function(e){var t=this[e];this.listenTo(t,"all",function(){this.trigger(e+":"+arguments[0],arguments[1])})},this))},_onParentRendered:function(){this.trigger("subviews:before:render");this._renderSubViews();this.trigger("subviews:after:render")},_renderSubViews:function(){var e=this._getOption("mainSubViewContainer");this._eachSubView(_.bind(function(t){var n=this.getParentEl();if(this._hasSubViewContainer(t)){n=this._getSubViewContainer(t)}else if(e){n=this.$(e)}this._renderSubView(t,n)},this))},_renderSubView:function(e,t){if(this._shouldRenderSubView(e)){this[e].render().$el.appendTo(t);this[e].delegateEvents()}},_shouldRenderSubView:function(e){var t=this._getSubViewRenderConditions()[e];var n=_.isFunction(t);return n?t.call(this):true},_eachSubView:function(e){if(this._getSubViews()){for(var t in this._getSubViews()){e(t,this._getSubViews()[t])}}},_eachSubViewEvent:function(e){var t=this._getOption("subViewEvents");if(t){for(var n in t){var r=this._splitSubViewEventKey(n);this._checkSubViewExistsForEvents(r.subViewName);var i=r.subViewName==="*"?"*":this[r.subViewName];e(i,r.subViewEventName,t[n])}}},_splitSubViewEventKey:function(e){var t=e.split(" ");return{subViewName:t[0],subViewEventName:t[1]}},_checkSubViewExistsForEvents:function(e){if(e!=="*"&&_.isUndefined(this[e])){throw new Error("Subview named "+e+" is not defined in subViews.")}},_hasSubViewContainer:function(e){var t=this._getOption("subViewContainers");return!_.isUndefined(t)&&!_.isUndefined(t[e])},_getSubViewContainer:function(e){if(!this._hasSubViewContainer(e)){throw new Error("No subview container for subView: "+e)}return this.$(this._getOption("subViewContainers")[e])},remove:function(){Backbone.Marionette.ItemView.prototype.remove.apply(this,arguments);this._removeSubViews()},_removeSubViews:function(){this._eachSubView(_.bind(function(e){this[e].remove()},this))},_getSubViews:function(){var e=_.result(this,"subViews");if(this.options.subViews){e=_.result(this.options,"subViews")}return e},_getOption:function(e){return this[e]||this.options[e]},_getSubViewRenderConditions:function(){return this._getOption("subViewRenderConditions")||{}}})